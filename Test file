Source = Excel.Workbook(File.Contents("F:\Rashmi_Learning\DATA\Emp_Training_Data.xlsx"), null, true),
    Emp_Sheet = Source{[Item="Emp",Kind="Sheet"]}[Data],
    #"Promoted Headers" = Table.PromoteHeaders(Emp_Sheet, [PromoteAllScalars=true]),
    #"Changed Type" = Table.TransformColumnTypes(#"Promoted Headers",{{"EmployeeID", Int64.Type}, {"ManagerID", Int64.Type}, {"Title", type text}, {"MaritalStatus", type text}, {"Gender", type text}, {"HireDate", type datetime}, {"Dept", type text}, {"Job Grade", type text}}),
    #"Renamed Columns" = Table.RenameColumns(#"Changed Type",{{"Title", "Full name"}}),
    #"Changed Type1" = Table.TransformColumnTypes(#"Renamed Columns",{{"HireDate", type date}}),
    #"Renamed Columns1" = Table.RenameColumns(#"Changed Type1",{{"HireDate", "DOB"}}),
    #"Replaced Value" = Table.ReplaceValue(#"Renamed Columns1","M","Male",Replacer.ReplaceText,{"MaritalStatus"}),
    #"Replaced Value1" = Table.ReplaceValue(#"Replaced Value","M","Married",Replacer.ReplaceText,{"MaritalStatus"}),
    #"Replaced Value2" = Table.ReplaceValue(#"Replaced Value1","Marriedale","Married",Replacer.ReplaceText,{"MaritalStatus"}),
    #"Replaced Value3" = Table.ReplaceValue(#"Replaced Value2","s","Single",Replacer.ReplaceText,{"MaritalStatus"}),
    #"Replaced Value4" = Table.ReplaceValue(#"Replaced Value3","S","Single",Replacer.ReplaceText,{"MaritalStatus"}),
    #"Replaced Value5" = Table.ReplaceValue(#"Replaced Value4","M","Male",Replacer.ReplaceText,{"Gender"}),
    #"Replaced Value6" = Table.ReplaceValue(#"Replaced Value5","FM","Female",Replacer.ReplaceText,{"Gender"}),
    #"Replaced Value7" = Table.ReplaceValue(#"Replaced Value6","F","Female",Replacer.ReplaceText,{"Gender"}),
    #"Inserted Age" = Table.AddColumn(#"Replaced Value7", "Age", each Date.From(DateTime.LocalNow()) - [DOB], type duration),
    #"Inserted Total Years" = Table.AddColumn(#"Inserted Age", "Total Years", each Duration.TotalDays([Age]) / 365, type number),
    #"Removed Columns" = Table.RemoveColumns(#"Inserted Total Years",{"Total Years"}),
    #"Changed Type2" = Table.TransformColumnTypes(#"Removed Columns",{{"Age", Int64.Type}}),
    #"Removed Columns1" = Table.RemoveColumns(#"Changed Type2",{"Age"}),
    #"Replaced Value8" = Table.ReplaceValue(#"Removed Columns1","Male","M",Replacer.ReplaceText,{"Gender"}),
    #"Replaced Value9" = Table.ReplaceValue(#"Replaced Value8","Female","F",Replacer.ReplaceText,{"Gender"}),
    #"Renamed Columns2" = Table.RenameColumns(#"Replaced Value9",{{"DOB", "Hire date"}}),
    #"Inserted Age1" = Table.AddColumn(#"Renamed Columns2", "Age", each Date.From(DateTime.LocalNow()) - [Hire date], type duration),
    #"Inserted Total Years1" = Table.AddColumn(#"Inserted Age1", "Total Years", each Duration.TotalDays([Age]) / 365, type number),
    #"Changed Type3" = Table.TransformColumnTypes(#"Inserted Total Years1",{{"Total Years", Int64.Type}}),
    #"Renamed Columns3" = Table.RenameColumns(#"Changed Type3",{{"Age", "Experience"}}),
    #"Inserted Text Before Delimiter" = Table.AddColumn(#"Renamed Columns3", "Text Before Delimiter", each Text.BeforeDelimiter([Full name], " "), type text),
    #"Inserted Text After Delimiter" = Table.AddColumn(#"Inserted Text Before Delimiter", "Text After Delimiter", each Text.AfterDelimiter([Full name], "   "), type text),
    #"Removed Columns2" = Table.RemoveColumns(#"Inserted Text After Delimiter",{"Text After Delimiter"}),
    #"Inserted Text After Delimiter1" = Table.AddColumn(#"Removed Columns2", "Text After Delimiter", each Text.AfterDelimiter([Full name], " "), type text),
    #"Inserted Text Length" = Table.AddColumn(#"Inserted Text After Delimiter1", "Length", each Text.Length([Full name]), Int64.Type),
    #"Inserted First Characters" = Table.AddColumn(#"Inserted Text Length", "First Characters", each Text.Start([Full name], 3), type text),
    #"Inserted Last Characters" = Table.AddColumn(#"Inserted First Characters", "Last Characters", each Text.End([Full name], 1), type text),
    #"Inserted Week of Month" = Table.AddColumn(#"Inserted Last Characters", "Week of Month", each Date.WeekOfMonth([Hire date]), Int64.Type),
    #"Merged Columns" = Table.CombineColumns(#"Inserted Week of Month",{"Job Grade", "Dept"},Combiner.CombineTextByDelimiter("--~", QuoteStyle.None),"Title"),
    #"Added Conditional Column" = Table.AddColumn(#"Merged Columns", "respected prefix", each if [Gender] = "Male" then "Mr" else if [Gender] = "Female" then "Ms" else if [Gender] = "Married" then "Mrs" else null),
    #"Removed Columns3" = Table.RemoveColumns(#"Added Conditional Column",{"respected prefix"}),
    #"Inserted Text Before Delimiter1" = Table.AddColumn(#"Removed Columns3", "Text Before Delimiter.1", each Text.BeforeDelimiter(Text.Lower([Full name]), " "), type text),
    #"Duplicated Column" = Table.AddColumn(#"Inserted Text Before Delimiter1", "Column with Example", each [MaritalStatus], type text),
    #"Added Conditional Column1" = Table.AddColumn(#"Duplicated Column", "Custom", each if [Gender] = "M" then "mr" else if [MaritalStatus] = "Single" then "ms" else if [MaritalStatus] = "Married" then "mrs" else null),
    #"Rename G to Gender" = Table.RenameColumns(#"Added Conditional Column1",{{"Gender", "Gender"}})
in
    #"Rename G to Gender"
